"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1236],{1559:(e,t,a)=>{a.d(t,{ToastProvider:()=>l,d:()=>c});var n=a(95155),o=a(12115),r=a(24775),s=a(27515);let i=(0,o.createContext)(void 0);function l(e){let{children:t}=e,[a,l]=(0,o.useState)([]),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,n=Math.random().toString(36).substring(7),o={id:n,message:e,type:t,duration:a};l(e=>[...e,o]),setTimeout(()=>{l(e=>e.filter(e=>e.id!==n))},a)},d=e=>{l(t=>t.filter(t=>t.id!==e))};return(0,n.jsxs)(i.Provider,{value:{showToast:c,showSuccess:e=>c(e,"success"),showError:e=>c(e,"error",6e3),showWarning:e=>c(e,"warning"),showInfo:e=>c(e,"info")},children:[t,a.map((e,t)=>(0,n.jsx)(r.A,{open:!0,autoHideDuration:e.duration,onClose:()=>d(e.id),anchorOrigin:{vertical:"top",horizontal:"right"},style:{top:"".concat(20+70*t,"px")},children:(0,n.jsx)(s.A,{onClose:()=>d(e.id),severity:e.type,variant:"filled",sx:{width:"100%",fontSize:"14px",fontWeight:"medium"},children:e.message})},e.id))]})}function c(){let e=(0,o.useContext)(i);if(void 0===e)throw Error("useToast must be used within a ToastProvider");return e}},8768:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(12115);let o=n.forwardRef(function(e,t){let{title:a,titleId:o,...r}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},r),a?n.createElement("title",{id:o},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))})},10874:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(12115);let o=n.forwardRef(function(e,t){let{title:a,titleId:o,...r}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},r),a?n.createElement("title",{id:o},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))})},14585:(e,t,a)=>{a.d(t,{j2:()=>i});var n=a(52078),o=a(64663),r=a(12553);let s=(0,n.Wp)({apiKey:"AIzaSyBhaPnfVZavlfHQ4UEbORmirHOhRHJvw4I",authDomain:"kallinai.firebaseapp.com",projectId:"kallinai",storageBucket:"kallinai.firebasestorage.app",messagingSenderId:"293968338314",appId:"1:293968338314:web:fe15f7265de96c6ef7bc73",measurementId:"G-1LDHKR8B7F"}),i=(0,r.xI)(s);(0,o.P5)(s)},21236:(e,t,a)=>{a.d(t,{default:()=>f});var n=a(95155),o=a(12115),r=a(55485),s=a(1559),i=a(41444),l=a(10874),c=a(8768),d=a(89731),u=a(42823);let m="\n  .custom-select {\n    accent-color: ".concat(u.T.zB,";\n  }\n  .custom-select option {\n    background-color: white;\n    color: black;\n  }\n  .custom-select option:hover {\n    background-color: ").concat(u.T.zB," !important;\n    background: ").concat(u.T.zB," !important;\n    color: white !important;\n  }\n  .custom-select option:focus {\n    background-color: ").concat(u.T.zB," !important;\n    background: ").concat(u.T.zB," !important;\n    color: white !important;\n  }\n  .custom-select option:checked {\n    background-color: ").concat(u.T.zB," !important;\n    background: ").concat(u.T.zB," !important;\n    color: white !important;\n  }\n  .custom-select option[selected] {\n    background-color: ").concat(u.T.zB," !important;\n    background: ").concat(u.T.zB," !important;\n    color: white !important;\n  }\n  \n  /* Dark mode styles */\n  .dark .custom-select option {\n    background-color: #374151;\n    color: white;\n  }\n  .dark .custom-select option:hover {\n    background-color: ").concat(u.T.zB," !important;\n    background: ").concat(u.T.zB," !important;\n    color: white !important;\n  }\n"),g="https://3758a6b3509d.ngrok-free.app/api",p="4214a0ea-b594-435d-9abb-599c1f3a81ea",h="https://api.vapi.ai";function f(){let{isDark:e}=(0,r.D)(),{showSuccess:t,showError:a}=(0,s.d)(),[f,y]=(0,o.useState)(""),[x,b]=(0,o.useState)(!1),[v,w]=(0,o.useState)(""),[k,A]=(0,o.useState)(""),[T,N]=(0,o.useState)([]),[I,S]=(0,o.useState)(!0),[j,O]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(g,"/auth/users"),{headers:{"ngrok-skip-browser-warning":"true"}});if(e.ok){let t=await e.json();N(t.users||t||[])}else console.error("Failed to fetch users:",e.status),a("Failed to load users data"),i.vF.logSystemAction("ASSISTANT_USER_DATA_FETCH_FAILED","Failed to fetch users: HTTP ".concat(e.status),"MEDIUM")}catch(e){console.error("Error fetching users:",e),a("Failed to connect to API"),i.vF.logSystemAction("ASSISTANT_USER_API_CONNECTION_FAILED","Failed to connect to user API: ".concat(e),"HIGH")}finally{S(!1)}})()},[a]);let E=async()=>{O(!0);try{console.log("\uD83D\uDD04 Starting VAPI sync process...");let a=await fetch("".concat(h,"/assistant"),{method:"GET",headers:{Authorization:"Bearer ".concat(p),"Content-Type":"application/json"}});if(!a.ok)throw Error("Failed to fetch VAPI assistants: ".concat(a.status));let n=await a.json();console.log("\uD83D\uDCE6 Fetched VAPI assistants:",n);let o=new Map;n.forEach(e=>{if(e.id){var t;let a="";if((null==(t=e.model)?void 0:t.messages)&&Array.isArray(e.model.messages)){let t=e.model.messages.find(e=>"system"===e.role);t&&(a=t.content||"")}o.set(e.id,{firstMessage:e.firstMessage||"",systemPrompt:a})}}),console.log("\uD83D\uDDFA️ Assistant mapping:",Array.from(o.entries()));let r=T.map(e=>{if(e.agent_id&&o.has(e.agent_id)){let t=o.get(e.agent_id);console.log("\uD83D\uDD04 Updating user ".concat(e.name," (").concat(e.agent_id,"):"),t);let a=t.systemPrompt;return{...e,prompt:a}}return e});try{let e=r.filter(e=>{let t=T.find(t=>t.id===e.id);return t&&t.prompt!==e.prompt});for(let t of(console.log("\uD83D\uDDC3️ Updating database with new prompts for users:",e.map(e=>({id:e.id,name:e.name}))),e)){console.log("\uD83D\uDCDD Updating prompt for user ".concat(t.name," (ID: ").concat(t.id,")"));let e=await fetch("".concat(g,"/auth/users/").concat(t.id,"/prompt"),{method:"PUT",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify({prompt:t.prompt})});e.ok?console.log("✅ Successfully updated prompt for user ".concat(t.name," in database")):console.warn("Failed to update prompt for user ".concat(t.id," in database:"),e.status)}}catch(e){console.warn("Failed to update database with new prompts:",e)}if(N(r),f){let t=r.find(e=>e.id.toString()===f);if(t){console.log("\uD83D\uDD04 Refreshing form with updated user data:",t);let a="Hello, Thank you for calling ".concat(t.name,". How can I help you today?"),n=t.prompt||"";if(t.agent_id&&o.has(t.agent_id)){let e=o.get(t.agent_id);a=e.firstMessage||a,n=e.systemPrompt||n}else if(t.prompt){var e;let o=null==(e=t.prompt)?void 0:e.match(/(?:Hello|Hi|Thank you for calling)[^.!?]*[.!?]/i);o&&(a=o[0].trim()),n=t.prompt}console.log("\uD83D\uDD04 Setting form state to:",{greetingMessage:a,systemPrompt:n}),w(a),A(n)}}console.log("✅ VAPI sync completed successfully"),t("Successfully synced with VAPI assistants"),i.vF.logSystemAction("VAPI_ASSISTANTS_SYNCED","Successfully synced ".concat(o.size," VAPI assistants with user database"),"MEDIUM")}catch(e){console.error("❌ Error syncing VAPI assistants:",e),a("Failed to sync with VAPI: ".concat(e instanceof Error?e.message:"Unknown error")),i.vF.logSystemAction("VAPI_SYNC_FAILED","Failed to sync VAPI assistants: ".concat(e),"HIGH")}finally{O(!1)}},C=async e=>{if(y(e),e){let a=T.find(t=>t.id.toString()===e);if(a){if(!a.agent_id){let e="Hello, Thank you for calling ".concat(a.name,". How can I help you today?"),t="You are a friendly, fast restaurant phone attendant for ".concat(a.name.toUpperCase(),". Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.\nStyle:\n-\nwarm, concise, professional. One to two sentences at a time.\nAsk one question at a time. Do not interrupt the caller.\nIf unsure, ask a clarifying question; don't guess.\nCore flow (follow in order):\n1) Greet Intent: \"Pickup or delivery today?\"\n2) Get name and callback number.\n3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.\n4) Take the order:\n-\nItem, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.\nIf an item is unavailable or unclear, offer close alternatives or best-sellers.\n5) Ask about allergies or dietary needs. Offer safe options without medical advice.\n6) Upsell gently (ONE quick option): sides, drinks, or desserts.\n7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.\n8) Quote timing: pickup-ready time or delivery estimate.\n9) Payment:\n-\nPrefer pay at pickup/delivery or a secure link if available.\nDo NOT collect full credit card numbers over the phone.");w(e),A(t);return}console.log("\uD83D\uDD04 [Dropdown] Fetching assistant configuration from VAPI for user ".concat(a.name," (Agent ID: ").concat(a.agent_id,")"));try{let e=await fetch("".concat(h,"/assistant/").concat(a.agent_id),{method:"GET",headers:{Authorization:"Bearer ".concat(p),"Content-Type":"application/json"}});if(e.ok){var t;let n=await e.json();console.log("\uD83D\uDCE6 [Dropdown] Fetched assistant data from VAPI:",JSON.stringify(n,null,2));let o=n.firstMessage||"Hello, Thank you for calling ".concat(a.name,". How can I help you today?"),r="";if((null==(t=n.model)?void 0:t.messages)&&Array.isArray(n.model.messages)){let e=n.model.messages.find(e=>"system"===e.role);e&&e.content&&(r=e.content)}r||(r="You are a friendly, fast restaurant phone attendant for ".concat(a.name.toUpperCase(),". Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.\nStyle:\n-\nwarm, concise, professional. One to two sentences at a time.\nAsk one question at a time. Do not interrupt the caller.\nIf unsure, ask a clarifying question; don't guess.\nCore flow (follow in order):\n1) Greet Intent: \"Pickup or delivery today?\"\n2) Get name and callback number.\n3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.\n4) Take the order:\n-\nItem, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.\nIf an item is unavailable or unclear, offer close alternatives or best-sellers.\n5) Ask about allergies or dietary needs. Offer safe options without medical advice.\n6) Upsell gently (ONE quick option): sides, drinks, or dessents.\n7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.\n8) Quote timing: pickup-ready time or delivery estimate.\n9) Payment:\n-\nPrefer pay at pickup/delivery or a secure link if available.\nDo NOT collect full credit card numbers over the phone.")),console.log("✅ [Dropdown] Using VAPI data:"),console.log("   Starting Message:",o),console.log("   System Prompt:",r.substring(0,100)+"..."),w(o),A(r)}else{let t=await e.json().catch(()=>({error:"Unknown error"}));console.error("❌ [Dropdown] Failed to fetch assistant from VAPI:",e.status,t);let n="Hello, Thank you for calling ".concat(a.name,". How can I help you today?"),o="You are a friendly, fast restaurant phone attendant for ".concat(a.name.toUpperCase(),". Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.\nStyle:\n-\nwarm, concise, professional. One to two sentences at a time.\nAsk one question at a time. Do not interrupt the caller.\nIf unsure, ask a clarifying question; don't guess.\nCore flow (follow in order):\n1) Greet Intent: \"Pickup or delivery today?\"\n2) Get name and callback number.\n3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.\n4) Take the order:\n-\nItem, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.\nIf an item is unavailable or unclear, offer close alternatives or best-sellers.\n5) Ask about allergies or dietary needs. Offer safe options without medical advice.\n6) Upsell gently (ONE quick option): sides, drinks, or desserts.\n7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.\n8) Quote timing: pickup-ready time or delivery estimate.\n9) Payment:\n-\nPrefer pay at pickup/delivery or a secure link if available.\nDo NOT collect full credit card numbers over the phone.");console.log("⚠️ [Dropdown] Using fallback defaults due to VAPI fetch failure"),w(n),A(o)}}catch(n){console.error("❌ [Dropdown] Error fetching assistant from VAPI:",n);let e="Hello, Thank you for calling ".concat(a.name,". How can I help you today?"),t="You are a friendly, fast restaurant phone attendant for ".concat(a.name.toUpperCase(),". Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.\nStyle:\n-\nwarm, concise, professional. One to two sentences at a time.\nAsk one question at a time. Do not interrupt the caller.\nIf unsure, ask a clarifying question; don't guess.\nCore flow (follow in order):\n1) Greet Intent: \"Pickup or delivery today?\"\n2) Get name and callback number.\n3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.\n4) Take the order:\n-\nItem, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.\nIf an item is unavailable or unclear, offer close alternatives or best-sellers.\n5) Ask about allergies or dietary needs. Offer safe options without medical advice.\n6) Upsell gently (ONE quick option): sides, drinks, or desserts.\n7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.\n8) Quote timing: pickup-ready time or delivery estimate.\n9) Payment:\n-\nPrefer pay at pickup/delivery or a secure link if available.\nDo NOT collect full credit card numbers over the phone.");console.log("⚠️ [Dropdown] Using fallback defaults due to VAPI error"),w(e),A(t)}}}else w(""),A("")},D=async()=>{if(f){let e=T.find(e=>e.id.toString()===f);if(e){if(!e.agent_id)return void a("No agent ID found for ".concat(e.name,". Cannot update VAPI assistant."));try{let n={firstMessage:v,backgroundSound:"office",model:{provider:"openai",model:"gpt-4o",toolIds:["351ff32f-5b41-4f96-a103-1d2b90b64574"],messages:[{content:k,role:"system"}]}};console.log("\uD83D\uDE80 Updating VAPI assistant:",e.agent_id),console.log("\uD83D\uDCDD Request body:",n);let o=await fetch("".concat(h,"/assistant/").concat(e.agent_id),{method:"PATCH",headers:{Authorization:"Bearer ".concat(p),"Content-Type":"application/json"},body:JSON.stringify(n)});if(o.ok){let a=await o.json();console.log("✅ VAPI assistant updated successfully:",a),console.log("\uD83D\uDCCB BEFORE SYNC - Form State:",{greetingMessage:v,systemPrompt:k,selectedUser:f,userAgentId:e.agent_id}),await E(),console.log("\uD83D\uDCCB AFTER SYNC - Form State:",{greetingMessage:v,systemPrompt:k,selectedUser:f,userAgentId:e.agent_id});let n=T.find(e=>e.id.toString()===f);n&&console.log("\uD83D\uDD0D VERIFICATION - Updated User Data:",{userName:n.name,prompt:n.prompt,formSystemPrompt:k,doTheyMatch:n.prompt===k}),i.vF.logPromptChanged(e.email,e.name,{oldPrompt:e.prompt||void 0,newPrompt:k}),t("Assistant configuration updated for ".concat(e.name))}else{let t=await o.json().catch(()=>({error:"Unknown error"}));console.error("❌ Failed to update VAPI assistant:",o.status,t),i.vF.logSystemAction("ASSISTANT_CONFIGURATION_FAILED","Failed to update VAPI assistant for: ".concat(e.name," - ").concat(JSON.stringify(t)),"HIGH"),a("Failed to update VAPI assistant: ".concat(t.error||t.message||"API request failed"));return}}catch(t){console.error("❌ Error updating VAPI assistant:",t),i.vF.logSystemAction("ASSISTANT_CONFIGURATION_ERROR","Error updating VAPI assistant for: ".concat(e.name," - ").concat(t),"HIGH"),a("Failed to connect to VAPI API: ".concat(t instanceof Error?t.message:"Unknown error"));return}}}else t("Changes saved successfully");b(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:m}}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold ".concat(e?"text-white":"text-gray-900"),children:"Assistant Management"}),(0,n.jsx)("p",{className:"mt-2 text-sm ".concat(e?"text-gray-400":"text-gray-600"),children:"Configure AI assistant prompts and settings for each restaurant"})]}),(0,n.jsxs)("button",{onClick:E,disabled:j||I,className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border transition-colors ".concat(j||I?"opacity-50 cursor-not-allowed":""),style:{color:e?u.T.Oh.Sh:u.T.Oh.eD,borderColor:e?u.T.Oh.l8:u.T.Oh.Sh},onMouseEnter:t=>{j||I||(t.currentTarget.style.backgroundColor=e?u.T.Oh.eD:u.T.Oh[50])},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},title:"Sync with VAPI assistants to get latest prompts",children:[(0,n.jsx)(l.A,{className:"h-4 w-4 mr-2 ".concat(j?"animate-spin":"")}),j?"Syncing...":"Sync VAPI"]})]}),I?(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-lg ".concat(e?"text-gray-300":"text-gray-600"),children:"Loading users..."})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)("label",{className:"text-sm font-medium",style:{color:e?u.T.Oh.Sh:u.T.Oh.eD},children:"Select User"})}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("select",{value:f,onChange:e=>C(e.target.value),className:"custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-pointer ".concat(e?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"," focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"),children:[(0,n.jsx)("option",{value:"",children:"-- Select a user --"}),T.filter(e=>e.agent_id).map(e=>(0,n.jsxs)("option",{value:e.id.toString(),children:[e.name," (#",e.id,")"]},e.id))]}),(0,n.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,n.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),!f&&(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)(c.A,{className:"mx-auto h-12 w-12 ".concat(e?"text-gray-600":"text-gray-400"),style:{color:e?u.T.Oh.l8:u.T.Oh.jC}}),(0,n.jsx)("h3",{className:"mt-2 text-sm font-medium",style:{color:e?u.T.Oh.Sh:u.T.Oh.uu},children:"Select a user to manage their VAPI configurations"}),(0,n.jsx)("p",{className:"mt-1 text-sm",style:{color:e?u.T.Oh.jC:u.T.Oh.C2},children:"Choose a user from the dropdown above to configure their assistant settings."})]}),f&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"".concat(e?"bg-gray-800 border-gray-700":"bg-white border-gray-200"," rounded-lg border p-4 mb-6"),children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-3 ".concat(e?"text-white":"text-gray-900"),children:"User Information"}),(()=>{let t=T.find(e=>e.id.toString()===f);return t?(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium uppercase tracking-wide ".concat(e?"text-gray-400":"text-gray-500"),children:"Restaurant Name"}),(0,n.jsx)("p",{className:"text-sm font-medium ".concat(e?"text-white":"text-gray-900"),children:t.name})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium uppercase tracking-wide ".concat(e?"text-gray-400":"text-gray-500"),children:"Email"}),(0,n.jsx)("p",{className:"text-sm ".concat(e?"text-gray-300":"text-gray-600"),children:t.email})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium uppercase tracking-wide ".concat(e?"text-gray-400":"text-gray-500"),children:"Agent ID"}),(0,n.jsx)("p",{className:"text-sm ".concat(e?"text-gray-300":"text-gray-600"),children:t.agent_id?(0,n.jsx)("span",{className:"font-mono text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:t.agent_id}):(0,n.jsx)("span",{className:"text-gray-400 italic",children:"No agent assigned"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium uppercase tracking-wide ".concat(e?"text-gray-400":"text-gray-500"),children:"Location"}),(0,n.jsx)("p",{className:"text-sm ".concat(e?"text-gray-300":"text-gray-600"),children:t.location||"Not specified"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium uppercase tracking-wide ".concat(e?"text-gray-400":"text-gray-500"),children:"Plan"}),(0,n.jsx)("p",{className:"text-sm ".concat(e?"text-gray-300":"text-gray-600"),children:t.plan?(0,n.jsx)("span",{className:"capitalize font-medium",style:{color:u.T.zB},children:t.plan}):(0,n.jsx)("span",{className:"text-gray-400 italic",children:"Free"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-medium uppercase tracking-wide ".concat(e?"text-gray-400":"text-gray-500"),children:"Status"}),(0,n.jsx)("p",{className:"text-sm",children:(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("active"===t.status.toLowerCase()?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300"),children:t.status})})]})]}):null})()]}),(0,n.jsxs)("div",{className:"".concat(e?"bg-gray-800 border-gray-700":"bg-white border-gray-200"," rounded-lg border p-4"),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold ".concat(e?"text-white":"text-gray-900"),children:"Assistant Configuration"}),(0,n.jsx)("div",{className:"flex items-center space-x-2",children:x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>{f?C(f):(w(""),A("")),b(!1)},className:"px-3 py-2 text-sm font-medium rounded-md border transition-colors",style:{color:e?u.T.Oh.Sh:u.T.Oh.eD,borderColor:e?u.T.Oh.l8:u.T.Oh.Sh},onMouseEnter:t=>{t.currentTarget.style.backgroundColor=e?u.T.Oh.eD:u.T.Oh[50]},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:"Cancel"}),(0,n.jsx)("button",{onClick:D,className:"px-3 py-2 text-sm font-medium text-white rounded-md transition-colors",style:{backgroundColor:u.T.zB},children:"Save Changes"})]}):(0,n.jsxs)("button",{onClick:()=>{f&&T.find(e=>e.id.toString()===f),b(!0)},className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-md border transition-colors",style:{color:e?u.T.Oh.Sh:u.T.Oh.eD,borderColor:e?u.T.Oh.l8:u.T.Oh.Sh},onMouseEnter:t=>{t.currentTarget.style.backgroundColor=e?u.T.Oh.eD:u.T.Oh[50]},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,n.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Edit"]})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)("label",{className:"text-sm font-medium",style:{color:e?u.T.Oh.Sh:u.T.Oh.eD},children:"Starting Message"})}),x?(0,n.jsx)("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500/20",style:{backgroundColor:e?u.T.Oh.eD:u.T.ON,borderColor:e?u.T.Oh.l8:u.T.Oh.Sh,color:e?u.T.ON:u.T.Oh.uu},onFocus:e=>{e.currentTarget.style.borderColor=u.T.zB},onBlur:t=>{t.currentTarget.style.borderColor=e?u.T.Oh.l8:u.T.Oh.Sh},placeholder:"Enter starting message"}):(0,n.jsx)("p",{className:"text-sm rounded-md p-3",style:{color:e?u.T.Oh.Sh:u.T.Oh.eD,backgroundColor:e?u.T.Oh.eD:u.T.Oh.Id},children:v})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)("label",{className:"text-sm font-medium",style:{color:e?u.T.Oh.Sh:u.T.Oh.eD},children:"System Prompt"})}),x?(0,n.jsx)("textarea",{rows:6,value:k,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-orange-500/20",style:{backgroundColor:e?u.T.Oh.eD:u.T.ON,borderColor:e?u.T.Oh.l8:u.T.Oh.Sh,color:e?u.T.ON:u.T.Oh.uu},onFocus:e=>{e.currentTarget.style.borderColor=u.T.zB},onBlur:t=>{t.currentTarget.style.borderColor=e?u.T.Oh.l8:u.T.Oh.Sh},placeholder:"Enter system prompt"}):(0,n.jsx)("p",{className:"text-sm rounded-md p-3 whitespace-pre-wrap",style:{color:e?u.T.Oh.Sh:u.T.Oh.eD,backgroundColor:e?u.T.Oh.eD:u.T.Oh.Id},children:k})]})]})]})]})]})]})}},41444:(e,t,a)=>{a.d(t,{Zx:()=>i,vF:()=>s,vN:()=>l});var n=a(19708),o=a(14585);class r{async logActivity(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"MEDIUM",s=arguments.length>4?arguments[4]:void 0;try{var i;let l=o.j2.currentUser;if(!l)return void console.warn("No authenticated user found for logging");let c={timestamp:new Date().toISOString(),adminId:l.uid,adminName:l.displayName||(null==(i=l.email)?void 0:i.split("@")[0])||"Unknown Admin",adminEmail:l.email||"unknown@example.com",action:e,category:t,details:a,severity:r,metadata:{...s,userAgent:window.navigator.userAgent,ipAddress:"Client-side"}};await (0,n.gS)(this.logsCollection,c),console.log("Activity logged:",e)}catch(e){console.error("Failed to log activity:",e)}}async getRecentLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;try{let t=(0,n.P)(this.logsCollection,(0,n.My)("timestamp","desc"),(0,n.AB)(e)),a=await (0,n.GG)(t),o=[];return a.forEach(e=>{o.push({id:e.id,...e.data()})}),o}catch(e){return console.error("Failed to fetch logs:",e),[]}}async getLogsByAdmin(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{let a=(0,n.P)(this.logsCollection,(0,n._M)("adminId","==",e),(0,n.My)("timestamp","desc"),(0,n.AB)(t)),o=await (0,n.GG)(a),r=[];return o.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){return console.error("Failed to fetch admin logs:",e),[]}}async getLogsByCategory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{let a=(0,n.P)(this.logsCollection,(0,n._M)("category","==",e),(0,n.My)("timestamp","desc"),(0,n.AB)(t)),o=await (0,n.GG)(a),r=[];return o.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){return console.error("Failed to fetch category logs:",e),[]}}async logPromptChanged(e,t,a){await this.logActivity("PROMPT_CHANGED","USER_MANAGEMENT","Admin changed prompt for ".concat(t," (").concat(e,")"),"MEDIUM",{targetEmail:e,targetUser:t,oldValue:a.oldPrompt,newValue:a.newPrompt})}async logMinutesAdded(e,t,a,n){await this.logActivity("MINUTES_ADDED","USER_MANAGEMENT","Admin added ".concat(a," minutes to ").concat(t," (").concat(e,"). New total: ").concat(n," minutes"),"MEDIUM",{targetEmail:e,targetUser:t,oldValue:n-a,newValue:n})}async logAdminCreated(e,t){await this.logActivity("ADMIN_CREATED","ADMIN_MANAGEMENT","New admin account created: ".concat(e," by ").concat(t),"HIGH",{targetEmail:e,createdBy:t})}async logAdminDeleted(e){await this.logActivity("ADMIN_DELETED","ADMIN_MANAGEMENT","Admin account deleted: ".concat(e),"CRITICAL",{targetEmail:e})}async logAdminUpdated(e,t){await this.logActivity("ADMIN_UPDATED","ADMIN_MANAGEMENT","Admin account updated: ".concat(e),"MEDIUM",{targetEmail:e,newValue:t})}async logUserAction(e,t,a){e.includes("LOGIN")||e.includes("LOGOUT")||await this.logActivity(e,"USER_MANAGEMENT",a,"MEDIUM",{targetEmail:t})}async logSystemAction(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"LOW";e.includes("LOGIN")||e.includes("LOGOUT")||e.includes("ADMIN_SIGNIN")||await this.logActivity(e,"SYSTEM",t,a)}constructor(){this.db=(0,n.aU)(),this.logsCollection=(0,n.rJ)(this.db,"activity_logs")}}let s=new r;s.logActivity.bind(s);let i=s.getRecentLogs.bind(s);s.getLogsByAdmin.bind(s);let l=s.getLogsByCategory.bind(s)},42823:e=>{e.exports=JSON.parse('{"T":{"zB":"#FE5B02","ON":"#FFFFFF","XT":"#1a1a1a","Oh":{"50":"#f9fafb","Id":"#f3f4f6","zT":"#e5e7eb","Sh":"#d1d5db","jC":"#9ca3af","C2":"#6b7280","l8":"#4b5563","eD":"#374151","n4":"#1f2937","uu":"#111827"}}}')},55485:(e,t,a)=>{a.d(t,{D:()=>i,ThemeProvider:()=>s});var n=a(95155),o=a(12115);let r=(0,o.createContext)(void 0);function s(e){let{children:t}=e,[a,s]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e=localStorage.getItem("kallin_theme");e?s("dark"===e):s(window.matchMedia("(prefers-color-scheme: dark)").matches)},[]),(0,o.useEffect)(()=>{a?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("kallin_theme",a?"dark":"light")},[a]),(0,n.jsx)(r.Provider,{value:{isDark:a,toggleTheme:()=>{s(e=>!e)}},children:t})}function i(){let e=(0,o.useContext)(r);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},89731:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(12115);let o=n.forwardRef(function(e,t){let{title:a,titleId:o,...r}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},r),a?n.createElement("title",{id:o},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))})}}]);