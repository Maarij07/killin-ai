"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7162],{1559:(e,t,a)=>{a.d(t,{ToastProvider:()=>l,d:()=>c});var r=a(95155),n=a(12115),s=a(24775),o=a(27515);let i=(0,n.createContext)(void 0);function l(e){let{children:t}=e,[a,l]=(0,n.useState)([]),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=Math.random().toString(36).substring(7),n={id:r,message:e,type:t,duration:a};l(e=>[...e,n]),setTimeout(()=>{l(e=>e.filter(e=>e.id!==r))},a)},d=e=>{l(t=>t.filter(t=>t.id!==e))};return(0,r.jsxs)(i.Provider,{value:{showToast:c,showSuccess:e=>c(e,"success"),showError:e=>c(e,"error",6e3),showWarning:e=>c(e,"warning"),showInfo:e=>c(e,"info")},children:[t,a.map((e,t)=>(0,r.jsx)(s.A,{open:!0,autoHideDuration:e.duration,onClose:()=>d(e.id),anchorOrigin:{vertical:"top",horizontal:"right"},style:{top:"".concat(20+70*t,"px")},children:(0,r.jsx)(o.A,{onClose:()=>d(e.id),severity:e.type,variant:"filled",sx:{width:"100%",fontSize:"14px",fontWeight:"medium"},children:e.message})},e.id))]})}function c(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useToast must be used within a ToastProvider");return e}},14585:(e,t,a)=>{a.d(t,{j2:()=>i});var r=a(52078),n=a(64663),s=a(12553);let o=(0,r.Wp)({apiKey:"AIzaSyBhaPnfVZavlfHQ4UEbORmirHOhRHJvw4I",authDomain:"kallinai.firebaseapp.com",projectId:"kallinai",storageBucket:"kallinai.firebasestorage.app",messagingSenderId:"293968338314",appId:"1:293968338314:web:fe15f7265de96c6ef7bc73",measurementId:"G-1LDHKR8B7F"}),i=(0,s.xI)(o);(0,n.P5)(o)},37162:(e,t,a)=>{a.d(t,{default:()=>A});var r=a(95155),n=a(12115),s=a(55485),o=a(1559),i=a(14585),l=a(12553),c=a(41444),d=a(19708),m=a(76849),u=a(41715),g=a(57218),x=a(24287),h=a(51915),y=a(89731),p=a(6956),b=a(23761),f=a(88125),v=a(42823),w=a(74264);let j="\n  .custom-select {\n    accent-color: ".concat(v.T.zB,";\n  }\n  .custom-select option {\n    background-color: white;\n    color: black;\n  }\n  .custom-select option:hover {\n    background-color: ").concat(v.T.zB," !important;\n    background: ").concat(v.T.zB," !important;\n    color: white !important;\n  }\n  .custom-select option:focus {\n    background-color: ").concat(v.T.zB," !important;\n    background: ").concat(v.T.zB," !important;\n    color: white !important;\n  }\n  .custom-select option:checked {\n    background-color: ").concat(v.T.zB," !important;\n    background: ").concat(v.T.zB," !important;\n    color: white !important;\n  }\n  .custom-select option[selected] {\n    background-color: ").concat(v.T.zB," !important;\n    background: ").concat(v.T.zB," !important;\n    color: white !important;\n  }\n  \n  /* Dark mode styles */\n  .dark .custom-select option {\n    background-color: #374151;\n    color: white;\n  }\n  .dark .custom-select option:hover {\n    background-color: ").concat(v.T.zB," !important;\n    background: ").concat(v.T.zB," !important;\n    color: white !important;\n  }\n");function A(){let{isDark:e}=(0,s.D)(),{showSuccess:t,showError:a}=(0,o.d)(),[A,N]=(0,n.useState)(""),[k,C]=(0,n.useState)([]),[E,F]=(0,n.useState)(!0),[D,S]=(0,n.useState)({isOpen:!1,admin:null}),[M,T]=(0,n.useState)({isOpen:!1,admin:null}),[I,L]=(0,n.useState)(!1),[B,U]=(0,n.useState)({status:"",role:"",permissions:""}),[O,P]=(0,n.useState)({name:"",email:"",role:"Admin"}),[_,G]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{try{let e=(0,d.aU)(),t=(0,d.rJ)(e,"admins"),a=(0,d.P)(t,(0,d.My)("createdAt","desc")),r=await (0,d.GG)(a),n=[];r.forEach(e=>{let t=e.data();n.push({id:e.id,name:t.name,email:t.email,status:t.status||"Active",role:t.role||"Admin",lastLogin:t.lastLogin||t.createdAt,permissions:t.permissions||"User Management",disabled:t.disabled||!1})}),C(n),console.log("Loaded admins from Firestore:",n)}catch(e){console.error("Error fetching admins:",e),_||(a("Failed to load administrators"),G(!0))}finally{F(!1)}})()},[a,_]);let z=k.filter(e=>e.name.toLowerCase().includes(A.toLowerCase())||e.email.toLowerCase().includes(A.toLowerCase())||e.id.includes(A)),H=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),R=e=>{let t=k.find(t=>t.id===e);t&&(U({status:t.status,role:t.role,permissions:t.permissions}),T({isOpen:!0,admin:t}))},W=async e=>{let r=k.find(t=>t.id===e);if(!r)return;let n=!r.disabled,s=n?"disable":"enable";try{let o=(0,d.aU)(),i=(0,d.H9)(o,"admins",e),l=await (0,d.x7)(i);if(l.exists()){let o=l.data().uid;if(o)try{let a=(0,m.Uz)(),s=(0,m.Qg)(a,"toggleAdminStatus"),i=await s({uid:o,adminDocId:e,disabled:n});console.log("Cloud Function result:",i),C(t=>t.map(t=>t.id===e?{...t,disabled:n}:t)),await c.vF.logAdminUpdated(r.email,{disabled:{old:r.disabled,new:n}}),t("Admin ".concat(r.name," has been ").concat(n?"disabled":"enabled"," successfully"))}catch(t){console.error("Cloud Function error:",t),console.log("Cloud Function failed, falling back to Firestore-only update"),await (0,d.mZ)(i,{disabled:n,updatedAt:new Date().toISOString()}),C(t=>t.map(t=>t.id===e?{...t,disabled:n}:t)),await c.vF.logAdminUpdated(r.email,{disabled:{old:r.disabled,new:n}}),a("Admin ".concat(r.name," was ").concat(s,"d in the system, but the Firebase account status could not be updated. This may require manual sync."))}else await (0,d.mZ)(i,{disabled:n,updatedAt:new Date().toISOString()}),C(t=>t.map(t=>t.id===e?{...t,disabled:n}:t)),await c.vF.logAdminUpdated(r.email,{disabled:{old:r.disabled,new:n}}),t("Admin ".concat(r.name," has been ").concat(s,"d successfully (no Firebase account found)"))}else a("Admin not found in database")}catch(e){console.error("Error ".concat(s,"ing admin:"),e),a("Failed to ".concat(s," admin. Please try again.")),await c.vF.logSystemAction("ADMIN_STATUS_CHANGE_FAILED","Failed to ".concat(s," admin: ").concat(r.email,". Error: ").concat(e),"HIGH")}},J=async()=>{if(D.admin){try{let e=(0,d.aU)(),r=D.admin.id,n=D.admin.name,s=D.admin.email,o=(0,d.H9)(e,"admins",r),i=await (0,d.x7)(o);if(i.exists()){let e=i.data().uid;if(e)try{let a=(0,m.Uz)(),o=(0,m.Qg)(a,"deleteAdminComplete"),i=await o({uid:e,adminDocId:r});console.log("Cloud Function result:",i),C(e=>e.filter(e=>e.id!==r)),await c.vF.logAdminDeleted(s),t("Admin ".concat(n," and their Firebase account have been completely deleted"))}catch(e){console.error("Cloud Function error:",e),console.log("Cloud Function failed, falling back to Firestore-only deletion"),await (0,d.kd)(o),C(e=>e.filter(e=>e.id!==r)),await c.vF.logAdminDeleted(s),a("Admin ".concat(n," was removed from the system, but the Firebase account could not be deleted. This may require manual cleanup."))}else await (0,d.kd)(o),C(e=>e.filter(e=>e.id!==r)),await c.vF.logAdminDeleted(s),t("Admin ".concat(n," has been deleted successfully (no Firebase account found)"))}else a("Admin not found in database")}catch(e){console.error("Error deleting admin:",e),a("Failed to delete admin. Please try again."),await c.vF.logSystemAction("ADMIN_DELETE_FAILED","Failed to delete admin: ".concat(D.admin.email,". Error: ").concat(e),"HIGH")}S({isOpen:!1,admin:null})}},V=()=>{S({isOpen:!1,admin:null})},Z=async()=>{if(M.admin){let e={status:B.status!==M.admin.status?{old:M.admin.status,new:B.status}:void 0,role:B.role!==M.admin.role?{old:M.admin.role,new:B.role}:void 0,permissions:B.permissions!==M.admin.permissions?{old:M.admin.permissions,new:B.permissions}:void 0};Object.values(e).some(e=>void 0!==e)&&await c.vF.logAdminUpdated(M.admin.email,e),t("Changes saved for ".concat(M.admin.name)),T({isOpen:!1,admin:null})}},q=()=>{T({isOpen:!1,admin:null})},Q=async()=>{var e,r;if(!O.name.trim())return void a("Please enter a full name");if(!O.email.trim())return void a("Please enter an email address");if(e=O.email,!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return void a("Please enter a valid email address");if("admin@gmail.com"===O.email.toLowerCase())return void a("Cannot add admin@gmail.com as it is reserved for the super admin");try{let e="TempAdmin123!"+Math.random().toString(36).substring(7),a=(await (0,l.eJ)(i.j2,O.email.trim().toLowerCase(),e)).user;console.log("Admin user created:",a.uid);let n=(0,d.aU)(),s={uid:a.uid,name:O.name.trim(),email:O.email.trim().toLowerCase(),status:"Active",role:"Admin",permissions:"User Management",createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},o=await (0,d.gS)((0,d.rJ)(n,"admins"),s);console.log("Admin data stored in Firestore:",o.id),await (0,l.J1)(i.j2,O.email.trim().toLowerCase());let m={id:o.id,name:s.name,email:s.email,status:s.status,role:s.role,lastLogin:s.lastLogin,permissions:s.permissions,disabled:!1};C(e=>[...e,m]),await c.vF.logAdminCreated(s.email,(null==(r=i.j2.currentUser)?void 0:r.email)||"Unknown"),t("Admin ".concat(O.name," created successfully! A password reset email has been sent to ").concat(O.email))}catch(e){console.error("Error creating admin:",e),"auth/email-already-in-use"===e.code?a("An account with this email already exists"):"auth/weak-password"===e.code?a("Password should be at least 6 characters long"):"auth/invalid-email"===e.code?a("Please enter a valid email address"):"auth/network-request-failed"===e.code?a("Network error. Please check your internet connection"):a("Failed to create admin account. Please try again.");return}L(!1),P({name:"",email:"",role:"Admin"})},K=()=>{L(!1),P({name:"",email:"",role:"Admin"})},X=(e,t)=>{U(a=>({...a,[e]:t}))},Y=(e,t)=>{P(a=>({...a,[e]:t}))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:j}}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold ".concat(e?"text-white":"text-gray-900"),children:"Administrator Management"}),(0,r.jsx)("p",{className:"mt-2 text-sm ".concat(e?"text-gray-400":"text-gray-600"),children:"Manage administrator accounts, permissions, and system access levels"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(u.A,{className:"h-5 w-5 ".concat(e?"text-gray-400":"text-gray-500")})}),(0,r.jsx)("input",{type:"text",placeholder:"Search administrators...",value:A,onChange:e=>N(e.target.value),className:"block w-full pl-10 pr-3 py-2.5 border rounded-lg text-sm shadow-sm ".concat(e?"bg-gray-800 border-gray-600 text-white placeholder-gray-400 focus:border-orange-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:border-orange-500"," focus:outline-none focus:ring-2 focus:ring-orange-500/20 transition-colors")})]}),(0,r.jsxs)("button",{onClick:()=>{L(!0)},className:"flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-white transition-all duration-200 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-orange-500/20 w-full sm:w-auto",style:{backgroundColor:v.T.zB},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#dc2626",onMouseLeave:e=>e.currentTarget.style.backgroundColor=v.T.zB,children:[(0,r.jsx)(g.A,{className:"h-4 w-4"}),"Add Admin"]})]})]}),E?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-lg ".concat(e?"text-gray-300":"text-gray-600"),children:"Loading administrators..."})]})}):(0,r.jsxs)("div",{className:"".concat(e?"bg-gray-800 border-gray-700":"bg-white border-gray-200"," rounded-lg border overflow-hidden"),children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,r.jsx)("thead",{className:e?"bg-gray-700":"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"hidden sm:table-cell px-3 sm:px-6 py-3 text-left text-xs font-medium ".concat(e?"text-gray-300":"text-gray-500"," uppercase tracking-wider"),children:"ID"}),(0,r.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium ".concat(e?"text-gray-300":"text-gray-500"," uppercase tracking-wider"),children:"NAME"}),(0,r.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium ".concat(e?"text-gray-300":"text-gray-500"," uppercase tracking-wider"),children:"STATUS"}),(0,r.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium ".concat(e?"text-gray-300":"text-gray-500"," uppercase tracking-wider"),children:"ROLE"}),(0,r.jsx)("th",{className:"hidden md:table-cell px-3 sm:px-6 py-3 text-left text-xs font-medium ".concat(e?"text-gray-300":"text-gray-500"," uppercase tracking-wider"),children:"LAST LOGIN"}),(0,r.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium ".concat(e?"text-gray-300":"text-gray-500"," uppercase tracking-wider"),children:"ACTIONS"})]})}),(0,r.jsx)("tbody",{className:"divide-y ".concat(e?"divide-gray-700":"divide-gray-200"),children:z.map(t=>{let a=((e,t)=>{if(t)return{bg:"#F3F4F6",text:"#6B7280",border:"#D1D5DB"};switch(e){case"Active":return{bg:"#DCFCE7",text:"#166534",border:"#BBF7D0"};case"Inactive":return{bg:"#FEF3C7",text:"#92400E",border:"#FDE68A"};default:return{bg:"#F3F4F6",text:"#374151",border:"#D1D5DB"}}})(t.status,t.disabled),n=(e=>{switch(e){case"Super Admin":return{bg:"#FEE2E2",text:"#991B1B",border:"#FECACA"};case"Admin":return{bg:"#E0F2FE",text:"#0C4A6E",border:"#BAE6FD"};default:return{bg:"#F3F4F6",text:"#374151",border:"#D1D5DB"}}})(t.role);return(0,r.jsxs)("tr",{className:"".concat(t.disabled?"opacity-50 bg-gray-50 dark:bg-gray-800":""," ").concat(e?"hover:bg-gray-700":"hover:bg-gray-50"," transition-all duration-200"),children:[(0,r.jsx)("td",{className:"hidden sm:table-cell px-3 sm:px-6 py-4 whitespace-nowrap text-sm font-medium ".concat(e?"text-gray-300":"text-gray-900"),children:t.id}),(0,r.jsx)("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-8 w-8",children:(0,r.jsx)("div",{className:"h-8 w-8 rounded-full flex items-center justify-center ".concat(t.disabled?"opacity-50":""),style:{backgroundColor:v.T.zB+"20"},children:(0,r.jsx)(x.A,{className:"h-5 w-5",style:{color:t.disabled?"#9CA3AF":v.T.zB}})})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsxs)("div",{className:"text-sm font-medium ".concat(t.disabled?"line-through":""," ").concat(e?"text-white":"text-gray-900"," ").concat(t.disabled?"text-gray-500":""),children:[t.name,t.disabled&&(0,r.jsx)("span",{className:"ml-2 inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:"Disabled"}),(0,r.jsx)("span",{className:"sm:hidden block text-xs font-normal ".concat(e?"text-gray-400":"text-gray-500"," mt-0.5"),children:t.id})]}),(0,r.jsx)("div",{className:"text-sm ".concat(t.disabled?"line-through":""," ").concat(e?"text-gray-400":"text-gray-500"),children:t.email})]})]})}),(0,r.jsx)("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full border",style:{backgroundColor:a.bg,color:a.text,borderColor:a.border},children:t.status})}),(0,r.jsxs)("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full border",style:{backgroundColor:n.bg,color:n.text,borderColor:n.border},children:t.role}),(0,r.jsx)("div",{className:"md:hidden text-xs ".concat(e?"text-gray-400":"text-gray-500"," mt-1"),children:H(t.lastLogin)})]}),(0,r.jsx)("td",{className:"hidden md:table-cell px-3 sm:px-6 py-4 whitespace-nowrap text-sm ".concat(e?"text-gray-300":"text-gray-900"),children:H(t.lastLogin)}),(0,r.jsx)("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,r.jsx)("button",{onClick:()=>R(t.id),className:"p-1.5 rounded-md transition-colors ".concat(e?"text-gray-400 hover:text-white hover:bg-gray-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),title:"Manage Admin",children:(0,r.jsx)(h.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>{R(t.id)},className:"p-1.5 rounded-md transition-colors ".concat(e?"text-gray-400 hover:text-white hover:bg-gray-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),title:"Edit Admin",children:(0,r.jsx)(y.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>W(t.id),className:"p-1.5 rounded-md transition-colors ".concat(t.disabled?e?"text-green-400 hover:text-green-300 hover:bg-gray-600":"text-green-600 hover:text-green-700 hover:bg-green-50":e?"text-orange-400 hover:text-orange-300 hover:bg-gray-600":"text-orange-600 hover:text-orange-700 hover:bg-orange-50"),title:t.disabled?"Enable Admin":"Disable Admin",children:t.disabled?(0,r.jsx)(p.A,{className:"h-4 w-4"}):(0,r.jsx)(b.A,{className:"h-4 w-4"})})]})})]},t.id)})})]})}),0===z.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(u.A,{className:"mx-auto h-12 w-12 ".concat(e?"text-gray-600":"text-gray-400")}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium ".concat(e?"text-gray-300":"text-gray-900"),children:"No administrators found"}),(0,r.jsx)("p",{className:"mt-1 text-sm ".concat(e?"text-gray-400":"text-gray-500"),children:A?"Try adjusting your search terms.":'Click "Add Admin" to create your first administrator.'})]})]}),(0,r.jsx)(w.A,{isOpen:I,onClose:K,title:"Add New Administrator",customContent:(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1.5 ".concat(e?"text-gray-300":"text-gray-700"),children:"Full Name"}),(0,r.jsx)("input",{type:"text",value:O.name,onChange:e=>Y("name",e.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm ".concat(e?"bg-gray-800 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"," focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"),placeholder:"Enter full name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1.5 ".concat(e?"text-gray-300":"text-gray-700"),children:"Email Address"}),(0,r.jsx)("input",{type:"email",value:O.email,onChange:e=>Y("email",e.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm ".concat(e?"bg-gray-800 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"," focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"),placeholder:"Enter email address"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1.5 ".concat(e?"text-gray-300":"text-gray-700"),children:"Role"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("select",{value:O.role,disabled:!0,className:"custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-not-allowed opacity-60 ".concat(e?"bg-gray-700 border-gray-600 text-gray-300":"bg-gray-100 border-gray-300 text-gray-700"),children:(0,r.jsx)("option",{value:"Admin",children:"Admin"})}),(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),primaryButton:{text:"Add Administrator",onClick:Q},secondaryButton:{text:"Cancel",onClick:K}}),(0,r.jsx)(w.A,{isOpen:M.isOpen,onClose:q,title:"Manage Administrator",customContent:M.admin?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 pb-3 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white",style:{backgroundColor:"#ea580c"},children:(0,r.jsx)(x.A,{className:"h-6 w-6"})})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-base ".concat(e?"text-white":"text-gray-900"),children:M.admin.name}),(0,r.jsx)("p",{className:"text-xs ".concat(e?"text-gray-400":"text-gray-600"),children:M.admin.id})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsx)("p",{className:"text-xs font-medium ".concat(e?"text-gray-300":"text-gray-700"),children:M.admin.permissions})})]})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1.5 ".concat(e?"text-gray-300":"text-gray-700"),children:"Admin Status"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{value:B.status,onChange:e=>X("status",e.target.value),className:"custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-pointer ".concat(e?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"," focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"),children:[(0,r.jsx)("option",{value:"Active",children:"Active"}),(0,r.jsx)("option",{value:"Inactive",children:"Inactive"})]}),(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1.5 ".concat(e?"text-gray-300":"text-gray-700"),children:"Role"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{value:B.role,onChange:e=>X("role",e.target.value),className:"custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-pointer ".concat(e?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"," focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"),children:[(0,r.jsx)("option",{value:"Super Admin",children:"Super Admin"}),(0,r.jsx)("option",{value:"Admin",children:"Admin"})]}),(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1.5 ".concat(e?"text-gray-300":"text-gray-700"),children:"Permissions"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{value:B.permissions,onChange:e=>X("permissions",e.target.value),className:"custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-pointer ".concat(e?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"," focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500"),children:[(0,r.jsx)("option",{value:"Full Access",children:"Full Access"}),(0,r.jsx)("option",{value:"User Management",children:"User Management"}),(0,r.jsx)("option",{value:"System Settings",children:"System Settings"}),(0,r.jsx)("option",{value:"Content Review",children:"Content Review"}),(0,r.jsx)("option",{value:"User Support",children:"User Support"})]}),(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})]}):null,primaryButton:{text:"Save Changes",onClick:Z},secondaryButton:{text:"Cancel",onClick:q}}),(0,r.jsx)(w.A,{isOpen:D.isOpen,onClose:V,icon:(0,r.jsx)(f.A,{className:"h-8 w-8"}),title:"Delete Administrator",description:D.admin?'Are you sure you want to delete administrator "'.concat(D.admin.name,'"? This action cannot be undone and will permanently remove all access privileges for this administrator.'):"",primaryButton:{text:"Delete Administrator",onClick:J},secondaryButton:{text:"Cancel",onClick:V}})]})]})}},41444:(e,t,a)=>{a.d(t,{Zx:()=>i,vF:()=>o,vN:()=>l});var r=a(19708),n=a(14585);class s{async logActivity(e,t,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"MEDIUM",o=arguments.length>4?arguments[4]:void 0;try{var i;let l=n.j2.currentUser;if(!l)return void console.warn("No authenticated user found for logging");let c={timestamp:new Date().toISOString(),adminId:l.uid,adminName:l.displayName||(null==(i=l.email)?void 0:i.split("@")[0])||"Unknown Admin",adminEmail:l.email||"unknown@example.com",action:e,category:t,details:a,severity:s,metadata:{...o,userAgent:window.navigator.userAgent,ipAddress:"Client-side"}};await (0,r.gS)(this.logsCollection,c),console.log("Activity logged:",e)}catch(e){console.error("Failed to log activity:",e)}}async getRecentLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;try{let t=(0,r.P)(this.logsCollection,(0,r.My)("timestamp","desc"),(0,r.AB)(e)),a=await (0,r.GG)(t),n=[];return a.forEach(e=>{n.push({id:e.id,...e.data()})}),n}catch(e){return console.error("Failed to fetch logs:",e),[]}}async getLogsByAdmin(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{let a=(0,r.P)(this.logsCollection,(0,r._M)("adminId","==",e),(0,r.My)("timestamp","desc"),(0,r.AB)(t)),n=await (0,r.GG)(a),s=[];return n.forEach(e=>{s.push({id:e.id,...e.data()})}),s}catch(e){return console.error("Failed to fetch admin logs:",e),[]}}async getLogsByCategory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{let a=(0,r.P)(this.logsCollection,(0,r._M)("category","==",e),(0,r.My)("timestamp","desc"),(0,r.AB)(t)),n=await (0,r.GG)(a),s=[];return n.forEach(e=>{s.push({id:e.id,...e.data()})}),s}catch(e){return console.error("Failed to fetch category logs:",e),[]}}async logPromptChanged(e,t,a){await this.logActivity("PROMPT_CHANGED","USER_MANAGEMENT","Admin changed prompt for ".concat(t," (").concat(e,")"),"MEDIUM",{targetEmail:e,targetUser:t,oldValue:a.oldPrompt,newValue:a.newPrompt})}async logMinutesAdded(e,t,a,r){await this.logActivity("MINUTES_ADDED","USER_MANAGEMENT","Admin added ".concat(a," minutes to ").concat(t," (").concat(e,"). New total: ").concat(r," minutes"),"MEDIUM",{targetEmail:e,targetUser:t,oldValue:r-a,newValue:r})}async logAdminCreated(e,t){await this.logActivity("ADMIN_CREATED","ADMIN_MANAGEMENT","New admin account created: ".concat(e," by ").concat(t),"HIGH",{targetEmail:e,createdBy:t})}async logAdminDeleted(e){await this.logActivity("ADMIN_DELETED","ADMIN_MANAGEMENT","Admin account deleted: ".concat(e),"CRITICAL",{targetEmail:e})}async logAdminUpdated(e,t){await this.logActivity("ADMIN_UPDATED","ADMIN_MANAGEMENT","Admin account updated: ".concat(e),"MEDIUM",{targetEmail:e,newValue:t})}async logUserAction(e,t,a){e.includes("LOGIN")||e.includes("LOGOUT")||await this.logActivity(e,"USER_MANAGEMENT",a,"MEDIUM",{targetEmail:t})}async logSystemAction(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"LOW";e.includes("LOGIN")||e.includes("LOGOUT")||e.includes("ADMIN_SIGNIN")||await this.logActivity(e,"SYSTEM",t,a)}constructor(){this.db=(0,r.aU)(),this.logsCollection=(0,r.rJ)(this.db,"activity_logs")}}let o=new s;o.logActivity.bind(o);let i=o.getRecentLogs.bind(o);o.getLogsByAdmin.bind(o);let l=o.getLogsByCategory.bind(o)},42823:e=>{e.exports=JSON.parse('{"T":{"zB":"#FE5B02","ON":"#FFFFFF","XT":"#1a1a1a","Oh":{"50":"#f9fafb","Id":"#f3f4f6","zT":"#e5e7eb","Sh":"#d1d5db","jC":"#9ca3af","C2":"#6b7280","l8":"#4b5563","eD":"#374151","n4":"#1f2937","uu":"#111827"}}}')},55485:(e,t,a)=>{a.d(t,{D:()=>i,ThemeProvider:()=>o});var r=a(95155),n=a(12115);let s=(0,n.createContext)(void 0);function o(e){let{children:t}=e,[a,o]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=localStorage.getItem("kallin_theme");e?o("dark"===e):o(window.matchMedia("(prefers-color-scheme: dark)").matches)},[]),(0,n.useEffect)(()=>{a?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("kallin_theme",a?"dark":"light")},[a]),(0,r.jsx)(s.Provider,{value:{isDark:a,toggleTheme:()=>{o(e=>!e)}},children:t})}function i(){let e=(0,n.useContext)(s);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},74264:(e,t,a)=>{a.d(t,{A:()=>i});var r=a(95155),n=a(12115),s=a(55485),o=a(42823);function i(e){let{isOpen:t,onClose:a,icon:i,title:l,description:c,customContent:d,primaryButton:m,secondaryButton:u={text:"Cancel",onClick:a}}=e,{isDark:g}=(0,s.D)();if((0,n.useEffect)(()=>{if(!t)return;let e=e=>{"Escape"===e.key&&a()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,a]),!t)return null;let x=e=>{e.target===e.currentTarget&&a()},h=m?(null==m?void 0:m.variant)==="danger"?{backgroundColor:"#DC2626",color:"white",hoverBackgroundColor:"#B91C1C"}:{backgroundColor:o.T.zB,color:"white",hoverBackgroundColor:"#e54d00"}:null;return(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:x,children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:x}),(0,r.jsx)("div",{className:"relative w-full ".concat(d?"max-w-4xl":"max-w-md"," mx-auto ").concat(g?"bg-gray-800 border-gray-700":"bg-white border-gray-200"," rounded-2xl border shadow-2xl"),onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"p-8 ".concat(d?"text-left":"text-center"),children:[i&&(0,r.jsx)("div",{className:"".concat(d?"":"mx-auto"," mb-6 w-16 h-16 rounded-full flex items-center justify-center bg-orange-100 ").concat(d?"mx-auto":""),children:(0,r.jsx)("div",{className:"text-orange-600",children:i})}),(0,r.jsx)("h3",{className:"text-xl font-semibold mb-3 ".concat(d?"text-center":""," ").concat(g?"text-white":"text-gray-900"),children:l}),d?(0,r.jsxs)("div",{children:[c&&(0,r.jsx)("p",{className:"text-sm mb-6 text-center leading-relaxed ".concat(g?"text-gray-400":"text-gray-600"),children:c}),(0,r.jsx)("div",{className:"mb-8",children:d})]}):(0,r.jsx)("p",{className:"text-sm mb-8 leading-relaxed ".concat(g?"text-gray-400":"text-gray-600"),children:c}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 ".concat(m?"":"justify-center"),children:[(0,r.jsx)("button",{onClick:u.onClick,className:"".concat(m?"flex-1":""," px-6 py-3 text-sm font-medium rounded-lg border transition-colors ").concat(g?"border-gray-600 text-gray-300 hover:bg-gray-700 hover:text-white":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:u.text}),m&&h&&(0,r.jsx)("button",{onClick:m.onClick,className:"flex-1 px-6 py-3 text-sm font-medium rounded-lg transition-all duration-200 hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2",style:{backgroundColor:h.backgroundColor,color:h.color},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=h.hoverBackgroundColor},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=h.backgroundColor},children:m.text})]})]})})]})}}}]);