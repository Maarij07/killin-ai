"use strict";exports.id=638,exports.ids=[638],exports.modules={7425:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(38301);let e=d.forwardRef(function({title:a,titleId:b,...c},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},c),a?d.createElement("title",{id:b},a):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))})},42303:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(38301);let e=d.forwardRef(function({title:a,titleId:b,...c},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},c),a?d.createElement("title",{id:b},a):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))})},56407:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(38301);let e=d.forwardRef(function({title:a,titleId:b,...c},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},c),a?d.createElement("title",{id:b},a):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))})},73918:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(38301);let e=d.forwardRef(function({title:a,titleId:b,...c},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},c),a?d.createElement("title",{id:b},a):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))})},90638:(a,b,c)=>{c.d(b,{default:()=>x});var d=c(21124),e=c(38301),f=c(14101),g=c(46479),h=c(90088),i=c(73918),j=c(56407),k=c(42303);let l=e.forwardRef(function({title:a,titleId:b,...c},d){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?e.createElement("title",{id:b},a):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))});var m=c(33843),n=c(7425);let o=e.forwardRef(function({title:a,titleId:b,...c},d){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?e.createElement("title",{id:b},a):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});var p=c(92073),q=c(95964),r=c(9614),s=c(39810);let t=`
  .custom-select {
    accent-color: ${r.T.zB};
  }
  .custom-select option {
    background-color: white;
    color: black;
  }
  .custom-select option:hover {
    background-color: ${r.T.zB} !important;
    background: ${r.T.zB} !important;
    color: white !important;
  }
  .custom-select option:focus {
    background-color: ${r.T.zB} !important;
    background: ${r.T.zB} !important;
    color: white !important;
  }
  .custom-select option:checked {
    background-color: ${r.T.zB} !important;
    background: ${r.T.zB} !important;
    color: white !important;
  }
  .custom-select option[selected] {
    background-color: ${r.T.zB} !important;
    background: ${r.T.zB} !important;
    color: white !important;
  }
  
  /* Dark mode styles */
  .dark .custom-select option {
    background-color: #374151;
    color: white;
  }
  .dark .custom-select option:hover {
    background-color: ${r.T.zB} !important;
    background: ${r.T.zB} !important;
    color: white !important;
  }
`,u="https://3758a6b3509d.ngrok-free.app/api",v="4214a0ea-b594-435d-9abb-599c1f3a81ea",w="https://api.vapi.ai";function x(){let{isDark:a}=(0,f.D)(),{showSuccess:b,showError:c}=(0,g.d)(),[x,y]=(0,e.useState)(""),[z,A]=(0,e.useState)([]),[B,C]=(0,e.useState)(!0),[D,E]=(0,e.useState)({isOpen:!1,user:null}),[F,G]=(0,e.useState)({isOpen:!1,user:null}),[H,I]=(0,e.useState)({isOpen:!1,user:null}),[J,K]=(0,e.useState)({status:"",addMinutes:"1",planSubscription:""}),[L,M]=(0,e.useState)(!1),[N,O]=(0,e.useState)(!1),[P,Q]=(0,e.useState)(null),[R,S]=(0,e.useState)({selectedUser:"",startingMessage:"",systemPrompt:"",isEditing:!1}),T=async a=>{try{console.log("\uD83D\uDD04 Starting VAPI sync for users...");let b=await fetch(`${w}/assistant`,{method:"GET",headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(!b.ok)return console.warn("⚠️ VAPI sync failed, using database data only"),a.map(a=>({...a,assistant_status:a.agent_id?"error":"no_assistant",last_synced:new Date().toISOString()}));let c=await b.json();console.log("\uD83D\uDCE6 Fetched VAPI assistants:",c.length);let d=new Map;c.forEach(a=>{if(a.id){let b="";if(a.model?.messages&&Array.isArray(a.model.messages)){let c=a.model.messages.find(a=>"system"===a.role);c&&(b=c.content||"")}d.set(a.id,{firstMessage:a.firstMessage||"",systemPrompt:b,lastSynced:new Date().toISOString()})}});let e=a.map(a=>{if(!a.agent_id)return{...a,assistant_status:"no_assistant",last_synced:new Date().toISOString()};if(!d.has(a.agent_id))return{...a,assistant_status:"error",last_synced:new Date().toISOString()};{let b=d.get(a.agent_id),c=a.prompt===b.systemPrompt;return{...a,prompt:b.systemPrompt,assistant_status:c?"synced":"out_of_sync",last_synced:b.lastSynced}}});return console.log("✅ VAPI sync completed for users"),e}catch(b){return console.error("❌ Error syncing with VAPI:",b),a.map(a=>({...a,assistant_status:a.agent_id?"error":"no_assistant",last_synced:new Date().toISOString()}))}},U=async()=>{O(!0);try{console.log("\uD83D\uDD04 Manual VAPI sync initiated...");let a=await T(z);A(a),Q(new Date),b("Successfully synced with VAPI assistants"),h.vF.logSystemAction("USER_VAPI_SYNC_COMPLETED",`Successfully synced ${a.filter(a=>a.agent_id).length} users with VAPI assistants`,"MEDIUM")}catch(a){console.error("❌ Manual VAPI sync failed:",a),c(`Failed to sync with VAPI: ${a instanceof Error?a.message:"Unknown error"}`),h.vF.logSystemAction("USER_VAPI_SYNC_FAILED",`Failed to sync users with VAPI: ${a}`,"HIGH")}finally{O(!1)}},V=z.filter(a=>a.name.toLowerCase().includes(x.toLowerCase())||a.email.toLowerCase().includes(x.toLowerCase())||a.id.toString().includes(x)),W=async a=>{let b=z.find(b=>b.id===a);if(b){if(!b.agent_id){let c=`Hello, Thank you for calling ${b.name}. How can I help you today?`,d=`You are a friendly, fast restaurant phone attendant for ${b.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`;S({selectedUser:a.toString(),startingMessage:c,systemPrompt:d,isEditing:!1}),I({isOpen:!0,user:b});return}console.log(`🔄 Fetching assistant configuration from VAPI for user ${b.name} (Agent ID: ${b.agent_id})`);try{let c=await fetch(`${w}/assistant/${b.agent_id}`,{method:"GET",headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(c.ok){let d=await c.json();console.log("\uD83D\uDCE6 Fetched assistant data from VAPI:",JSON.stringify(d,null,2));let e=d.firstMessage||`Hello, Thank you for calling ${b.name}. How can I help you today?`,f="";if(d.model?.messages&&Array.isArray(d.model.messages)){let a=d.model.messages.find(a=>"system"===a.role);a&&a.content&&(f=a.content)}f||(f=`You are a friendly, fast restaurant phone attendant for ${b.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`),console.log("✅ Using VAPI data:"),console.log("   Starting Message:",e),console.log("   System Prompt:",f.substring(0,100)+"..."),S({selectedUser:a.toString(),startingMessage:e,systemPrompt:f,isEditing:!1})}else{let d=await c.json().catch(()=>({error:"Unknown error"}));console.error("❌ Failed to fetch assistant from VAPI:",c.status,d);let e=`Hello, Thank you for calling ${b.name}. How can I help you today?`,f=`You are a friendly, fast restaurant phone attendant for ${b.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`;console.log("⚠️ Using fallback defaults due to VAPI fetch failure"),S({selectedUser:a.toString(),startingMessage:e,systemPrompt:f,isEditing:!1})}}catch(e){console.error("❌ Error fetching assistant from VAPI:",e);let c=`Hello, Thank you for calling ${b.name}. How can I help you today?`,d=`You are a friendly, fast restaurant phone attendant for ${b.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`;console.log("⚠️ Using fallback defaults due to VAPI error"),S({selectedUser:a.toString(),startingMessage:c,systemPrompt:d,isEditing:!1})}I({isOpen:!0,user:b})}},X=()=>{E({isOpen:!1,user:null})},Y=async()=>{if(F.user){M(!0);let a=parseInt(J.addMinutes)||0,d=F.user.minutes_allowed+a,e={oldStatus:F.user.status,newStatus:J.status,oldMinutes:F.user.minutes_allowed.toString(),addedMinutes:a.toString(),newMinutes:d.toString(),oldPlan:F.user.plan||"basic",newPlan:J.planSubscription};a>0&&h.vF.logMinutesAdded(F.user.email,F.user.name,a,d);try{let f="custom";f=e.oldPlan!==e.newPlan?({basic:"basic",premium:"premium",enterprise:"enterprise"})[e.newPlan]||"basic":"custom";let g={user_id:F.user.id,plan_type:f,amount_paid:0,transaction_id:"",payment_intent_id:"",minutes:a,is_admin:!0};console.log("Sending payment confirmation API call:",g);let i=await fetch(`${u}/stripe/confirm-payment`,{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(g)});if(i.ok){let a=await i.json();console.log("Payment confirmation API response:",a),h.vF.logUserAction("USER_PAYMENT_CONFIRMED",F.user.email,`Admin updated user via payment API: ${F.user.name} (ID: ${F.user.id}). Plan: ${f}, Minutes: ${d}`),b(`Changes saved for ${F.user.name}`),(async()=>{try{let a=await fetch(`${u}/auth/users`,{headers:{"ngrok-skip-browser-warning":"true"}});if(a.ok){let b=await a.json();A(b.users||b||[])}}catch(a){console.error("Error refreshing users:",a)}})()}else{let a=await i.json().catch(()=>({error:"Unknown error"}));console.error("Payment confirmation API failed:",i.status,a),h.vF.logUserAction("USER_PAYMENT_CONFIRMATION_FAILED",F.user.email,`Admin failed to update user via payment API: ${F.user.name} (ID: ${F.user.id}). Error: ${i.status} - ${JSON.stringify(a)}`),c(`Failed to save changes: ${a.message||a.error||"API request failed"}`);return}}catch(a){console.error("Error calling payment confirmation API:",a),h.vF.logUserAction("USER_PAYMENT_API_ERROR",F.user.email,`Admin encountered error calling payment API for user: ${F.user.name} (ID: ${F.user.id}). Error: ${a}`),c(`Failed to connect to API: ${a instanceof Error?a.message:"Unknown error"}`);return}finally{M(!1)}G({isOpen:!1,user:null})}},Z=()=>{G({isOpen:!1,user:null})},$=(a,b)=>{K(c=>({...c,[a]:b}))},_=async(a,b)=>{if(S(c=>({...c,[a]:b})),"selectedUser"===a&&b){let a=z.find(a=>a.id.toString()===b);if(a){if(!a.agent_id){let c=`Hello, Thank you for calling ${a.name}. How can I help you today?`,d=`You are a friendly, fast restaurant phone attendant for ${a.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`;S(a=>({...a,selectedUser:b,startingMessage:c,systemPrompt:d}));return}console.log(`🔄 [Dropdown] Fetching assistant configuration from VAPI for user ${a.name} (Agent ID: ${a.agent_id})`);try{let c=await fetch(`${w}/assistant/${a.agent_id}`,{method:"GET",headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(c.ok){let d=await c.json();console.log("\uD83D\uDCE6 [Dropdown] Fetched assistant data from VAPI:",JSON.stringify(d,null,2));let e=d.firstMessage||`Hello, Thank you for calling ${a.name}. How can I help you today?`,f="";if(d.model?.messages&&Array.isArray(d.model.messages)){let a=d.model.messages.find(a=>"system"===a.role);a&&a.content&&(f=a.content)}f||(f=`You are a friendly, fast restaurant phone attendant for ${a.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`),console.log("✅ [Dropdown] Using VAPI data:"),console.log("   Starting Message:",e),console.log("   System Prompt:",f.substring(0,100)+"..."),S(a=>({...a,selectedUser:b,startingMessage:e,systemPrompt:f}))}else{let d=await c.json().catch(()=>({error:"Unknown error"}));console.error("❌ [Dropdown] Failed to fetch assistant from VAPI:",c.status,d);let e=`Hello, Thank you for calling ${a.name}. How can I help you today?`,f=`You are a friendly, fast restaurant phone attendant for ${a.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`;console.log("⚠️ [Dropdown] Using fallback defaults due to VAPI fetch failure"),S(a=>({...a,selectedUser:b,startingMessage:e,systemPrompt:f}))}}catch(e){console.error("❌ [Dropdown] Error fetching assistant from VAPI:",e);let c=`Hello, Thank you for calling ${a.name}. How can I help you today?`,d=`You are a friendly, fast restaurant phone attendant for ${a.name.toUpperCase()}. Goal: Ask for the customer's name, take accurate pickup or delivery orders and confirm timing--clearly, politely, and in as few words as possible.
Style:
-
warm, concise, professional. One to two sentences at a time.
Ask one question at a time. Do not interrupt the caller.
If unsure, ask a clarifying question; don't guess.
Core flow (follow in order):
1) Greet Intent: "Pickup or delivery today?"
2) Get name and callback number.
3) For delivery: get full address (street, apartment, city) and any gate/buzzer notes.
4) Take the order:
-
Item, size/variant, quantity, options (sauce/spice/temperature), extras, special instructions.
If an item is unavailable or unclear, offer close alternatives or best-sellers.
5) Ask about allergies or dietary needs. Offer safe options without medical advice.
6) Upsell gently (ONE quick option): sides, drinks, or desserts.
7) Read-back and confirm: items, quantities, options, subtotal if known, delivery fee/taxes, and total if available.
8) Quote timing: pickup-ready time or delivery estimate.
9) Payment:
-
Prefer pay at pickup/delivery or a secure link if available.
Do NOT collect full credit card numbers over the phone.`;console.log("⚠️ [Dropdown] Using fallback defaults due to VAPI error"),S(a=>({...a,selectedUser:b,startingMessage:c,systemPrompt:d}))}}}},aa=async()=>{if(console.log("\uD83D\uDCBE saveVapiChanges function called!"),console.log("Current vapiForm state:",R),R.selectedUser){let a=z.find(a=>a.id.toString()===R.selectedUser);if(console.log("Selected user data:",a),a){if(console.log("Agent ID found:",a.agent_id),!a.agent_id){c(`No agent ID found for ${a.name}. Cannot update VAPI assistant.`),h.vF.logUserAction("USER_VAPI_UPDATE_FAILED",a.email,`Admin attempted to update VAPI configuration but no agent_id found for user: ${a.name} (ID: ${a.id})`);return}try{console.log("\uD83D\uDD0D === AGENT ID DEBUGGING ==="),console.log("selectedUser object:",JSON.stringify(a,null,2)),console.log("selectedUser.agent_id:",a.agent_id),console.log("typeof selectedUser.agent_id:",typeof a.agent_id),console.log("selectedUser.agent_id length:",a.agent_id?a.agent_id.length:"null"),console.log("=== END AGENT ID DEBUGGING ==="),console.log("Testing assistant existence with GET request...");let d=await fetch(`https://api.vapi.ai/assistant/${a.agent_id}`,{method:"GET",headers:{Authorization:"Bearer 4214a0ea-b594-435d-9abb-599c1f3a81ea","Content-Type":"application/json"}});if(console.log("GET Response Status:",d.status),d.ok){let a=await d.json();console.log("\uD83D\uDD0D Current Assistant Data:",JSON.stringify(a,null,2)),a.model&&a.model.toolIds?console.log("⚠️ WARNING: Assistant currently has toolIds:",a.model.toolIds):console.log("✅ Assistant does NOT currently have toolIds")}else{let b=await d.json().catch(()=>({error:"Unknown error"}));if(console.error("Assistant GET failed:",d.status,b),404===d.status){console.error("\uD83D\uDEA8 AGENT NOT FOUND! The agent_id might be incorrect."),c(`Assistant with ID ${a.agent_id} not found. Please check the agent ID.`);return}}let e=`https://api.vapi.ai/assistant/${a.agent_id}`,f={firstMessage:R.startingMessage,backgroundSound:"office",model:{provider:"openai",model:"gpt-4o",toolIds:["351ff32f-5b41-4f96-a103-1d2b90b64574"],messages:[{content:R.systemPrompt,role:"system"}]}};console.log("\uD83D\uDE80 === MINIMAL VAPI API REQUEST TEST ==="),console.log("URL:",e),console.log("Method: PATCH"),console.log("Headers:",{Authorization:"Bearer 4214a0ea-b594-435d-9abb-599c1f3a81ea","Content-Type":"application/json"}),console.log("Body:",JSON.stringify(f,null,2)),console.log("Agent ID:",a.agent_id),console.log("=== END REQUEST DETAILS ===");let g=await fetch(e,{method:"PATCH",headers:{Authorization:"Bearer 4214a0ea-b594-435d-9abb-599c1f3a81ea","Content-Type":"application/json"},body:JSON.stringify(f)});if(g.ok){let c=await g.json();console.log("VAPI assistant updated successfully:",c),h.vF.logPromptChanged(a.email,a.name,{oldPrompt:a.prompt||void 0,newPrompt:R.systemPrompt}),b(`VAPI configuration saved for ${a.name}`),S(a=>({...a,isEditing:!1}));try{console.log("\uD83D\uDD04 Fetching updated assistant data from VAPI..."),console.log("\uD83D\uDD0D Agent ID being used:",a.agent_id),await new Promise(a=>setTimeout(a,1e3));let b=await fetch(`${w}/assistant/${a.agent_id}`,{method:"GET",headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(console.log("\uD83D\uDCE1 Updated assistant response status:",b.status),b.ok){let c=await b.json();console.log("\uD83D\uDCE6 Fetched updated assistant full data:",JSON.stringify(c,null,2));let d="",e=c.firstMessage||"";if(c.model?.messages&&Array.isArray(c.model.messages)){let a=c.model.messages.find(a=>"system"===a.role);a&&(d=a.content||"")}console.log("\uD83D\uDCDD Extracted data:"),console.log("   Starting Message:",e),console.log("   System Prompt (first 100 chars):",d.substring(0,100)+"...");let f=z.map(b=>b.id===a.id?{...b,prompt:d}:b);console.log("\uD83D\uDD04 Updating users state..."),A(f),console.log("\uD83D\uDD04 Updating VAPI form state...");let g={selectedUser:a.id.toString(),startingMessage:e,systemPrompt:d,isEditing:!1};console.log("\uD83D\uDCDD New form state:",g),S(g),console.log("\n\uD83D\uDD25 === REAL-TIME SYNC VERIFICATION ==="),console.log("\uD83D\uDCCA VAPI API Response Data:"),console.log("   Starting Message (firstMessage):",`"${e}"`),console.log("   System Prompt (model.messages[0].content):"),console.log("   ",d.substring(0,200)+"..."),console.log("\n\uD83D\uDCF1 Frontend Form State:"),console.log("   Starting Message:",`"${g.startingMessage}"`),console.log("   System Prompt:"),console.log("   ",g.systemPrompt.substring(0,200)+"..."),console.log("\n\uD83C\uDFAF Sync Status:"),console.log("   Starting Messages Match:",e===g.startingMessage?"✅ YES":"❌ NO"),console.log("   System Prompts Match:",d===g.systemPrompt?"✅ YES":"❌ NO"),console.log("\uD83D\uDD25 === END VERIFICATION ===\n");try{console.log(`📝 Attempting to update prompt for user ${a.name} (ID: ${a.id}) in database`);let b=new AbortController,c=setTimeout(()=>b.abort(),5e3),e=await fetch(`${u}/auth/users/${a.id}/prompt`,{method:"PUT",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true",Accept:"application/json"},body:JSON.stringify({prompt:d}),signal:b.signal});clearTimeout(c),e.ok?console.log(`✅ Successfully updated prompt for user ${a.name} in database`):console.warn(`⚠️ Database update failed for user ${a.id}:`,e.status,"This is optional and won't affect VAPI functionality")}catch(a){console.warn("⚠️ Database update failed (optional):",a instanceof Error?a.message:"Unknown error","- VAPI update was successful")}console.log("✅ VAPI form refreshed with updated data"),setTimeout(()=>{console.log("\uD83D\uDD04 Force refreshing form state..."),S({selectedUser:a.id.toString(),startingMessage:e,systemPrompt:d,isEditing:!1})},100)}else{let a=await b.text();console.error("Failed to fetch updated assistant:",b.status,a),console.log("\uD83D\uDD04 Using locally saved data since fetch failed..."),S(a=>({...a,isEditing:!1}))}}catch(a){console.error("Error fetching updated assistant data:",a),console.log("\uD83D\uDD04 Using locally saved data due to sync error..."),S(a=>({...a,isEditing:!1}))}}else{let b=await g.json().catch(()=>({error:"Unknown error"}));console.error("Failed to update VAPI assistant:",g.status,b),h.vF.logUserAction("USER_VAPI_UPDATE_FAILED",a.email,`Admin failed to update VAPI configuration for user: ${a.name} (ID: ${a.id}). API Error: ${g.status} - ${JSON.stringify(b)}`),c(`Failed to update VAPI configuration: ${b.error||"API request failed"}`)}}catch(b){console.error("Error updating VAPI assistant:",b),h.vF.logUserAction("USER_VAPI_UPDATE_ERROR",a.email,`Admin encountered error updating VAPI configuration for user: ${a.name} (ID: ${a.id}). Error: ${b}`),c(`Failed to connect to VAPI API: ${b instanceof Error?b.message:"Unknown error"}`)}}}},ab=()=>{I({isOpen:!1,user:null}),S({selectedUser:"",startingMessage:"",systemPrompt:"",isEditing:!1})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("style",{dangerouslySetInnerHTML:{__html:t}}),(0,d.jsx)("div",{className:"space-y-6",children:B?(0,d.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),(0,d.jsx)("p",{className:`text-lg ${a?"text-gray-300":"text-gray-600"}`,children:"Loading users..."})]})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:`text-2xl font-bold ${a?"text-white":"text-gray-900"}`,children:"User Management"}),(0,d.jsxs)("p",{className:`mt-2 text-sm ${a?"text-gray-400":"text-gray-600"}`,children:["Manage user accounts, permissions, and access controls",P&&(0,d.jsxs)("span",{className:`ml-2 text-xs ${a?"text-gray-500":"text-gray-400"}`,children:["• Last synced: ",P.toLocaleTimeString()]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsxs)("button",{onClick:U,disabled:N||B,className:`inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border transition-colors ${N||B?"opacity-50 cursor-not-allowed":""}`,style:{color:a?r.T.Oh.Sh:r.T.Oh.eD,borderColor:a?r.T.Oh.l8:r.T.Oh.Sh},onMouseEnter:b=>{N||B||(b.currentTarget.style.backgroundColor=a?r.T.Oh.eD:r.T.Oh[50])},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent"},title:"Sync with VAPI to get latest assistant data",children:[(0,d.jsx)(i.A,{className:`h-4 w-4 mr-2 ${N?"animate-spin":""}`}),N?"Syncing...":"Sync VAPI"]}),(0,d.jsxs)("div",{className:"relative w-80",children:[(0,d.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,d.jsx)(j.A,{className:`h-5 w-5 ${a?"text-gray-400":"text-gray-500"}`})}),(0,d.jsx)("input",{type:"text",placeholder:"Search users...",value:x,onChange:a=>y(a.target.value),className:`block w-full pl-10 pr-3 py-2.5 border rounded-lg text-sm shadow-sm ${a?"bg-gray-800 border-gray-600 text-white placeholder-gray-400 focus:border-orange-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:border-orange-500"} focus:outline-none focus:ring-2 focus:ring-orange-500/20 transition-colors`})]})]})]}),(0,d.jsxs)("div",{className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-lg border overflow-hidden`,children:[(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,d.jsx)("thead",{className:a?"bg-gray-700":"bg-gray-50",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:`px-6 py-3 text-left text-xs font-medium ${a?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"SR."}),(0,d.jsx)("th",{className:`px-6 py-3 text-left text-xs font-medium ${a?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"NAME"}),(0,d.jsx)("th",{className:`px-6 py-3 text-left text-xs font-medium ${a?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"STATUS"}),(0,d.jsx)("th",{className:`px-6 py-3 text-left text-xs font-medium ${a?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"PLAN"}),(0,d.jsx)("th",{className:`px-6 py-3 text-left text-xs font-medium ${a?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"MINUTES"}),(0,d.jsx)("th",{className:`px-6 py-3 text-left text-xs font-medium ${a?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"ASSISTANT"}),(0,d.jsx)("th",{className:`px-6 py-3 text-left text-xs font-medium ${a?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"ACTIONS"})]})}),(0,d.jsx)("tbody",{className:`divide-y ${a?"divide-gray-700":"divide-gray-200"}`,children:V.map(b=>{var c;let e=(a=>{switch(a.toLowerCase()){case"active":return{bg:"#DCFCE7",text:"#166534",border:"#BBF7D0"};case"inactive":return{bg:"#FEF3C7",text:"#92400E",border:"#FDE68A"};default:return{bg:"#F3F4F6",text:"#374151",border:"#D1D5DB"}}})(b.status),f=(a=>{switch((a||"").toLowerCase()){case"basic":case"":case"starter":return{bg:"#DBEAFE",text:"#1D4ED8",border:"#93C5FD"};case"premium":case"popular":return{bg:"#D1FAE5",text:"#065F46",border:"#A7F3D0"};case"enterprise":case"pro":return{bg:"#E9D5FF",text:"#7C3AED",border:"#C4B5FD"};case"free":return{bg:"#F3F4F6",text:"#6B7280",border:"#D1D5DB"};default:return{bg:"#F3F4F6",text:"#374151",border:"#D1D5DB"}}})(b.plan);return(0,d.jsxs)("tr",{className:`${a?"hover:bg-gray-700":"hover:bg-gray-50"} transition-colors`,children:[(0,d.jsxs)("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${a?"text-gray-300":"text-gray-900"}`,children:["#",b.id]}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"flex-shrink-0 h-8 w-8",children:(0,d.jsx)("div",{className:"h-8 w-8 rounded-full flex items-center justify-center",style:{backgroundColor:`${r.T.zB}20`},children:(0,d.jsx)(k.A,{className:"h-5 w-5",style:{color:r.T.zB}})})}),(0,d.jsxs)("div",{className:"ml-3",children:[(0,d.jsx)("div",{className:`text-sm font-medium ${a?"text-white":"text-gray-900"}`,children:b.name}),(0,d.jsx)("div",{className:`text-sm ${a?"text-gray-400":"text-gray-500"}`,children:b.email})]})]})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full border",style:{backgroundColor:e.bg,color:e.text,borderColor:e.border},children:b.status})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full border",style:{backgroundColor:f.bg,color:f.text,borderColor:f.border},children:(c=b.plan)&&""!==c.trim()?c.charAt(0).toUpperCase()+c.slice(1).toLowerCase():"Free"})}),(0,d.jsx)("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${a?"text-gray-300":"text-gray-900"}`,children:(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsxs)("span",{className:"font-medium",children:[b.minutes_used,"/",b.minutes_allowed]}),(0,d.jsx)("div",{className:`w-16 h-1 rounded-full mt-1 ${a?"bg-gray-700":"bg-gray-200"}`,children:(0,d.jsx)("div",{className:"h-1 rounded-full bg-orange-500",style:{width:`${Math.min(b.minutes_used/b.minutes_allowed*100,100)}%`}})})]})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(()=>{let c=(a=>{switch(a){case"synced":return{color:"#10B981",bgColor:"#ECFDF5",text:"Synced",icon:"✅",description:"Assistant is in sync with VAPI"};case"out_of_sync":return{color:"#F59E0B",bgColor:"#FFFBEB",text:"Out of Sync",icon:"⚠️",description:"Assistant data differs from VAPI"};case"error":return{color:"#EF4444",bgColor:"#FEF2F2",text:"Error",icon:"❌",description:"Failed to connect to VAPI"};default:return{color:"#6B7280",bgColor:"#F9FAFB",text:"No Assistant",icon:"➖",description:"No assistant configured"}}})(b.assistant_status);return(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsxs)("div",{className:"flex items-center px-2 py-1 text-xs font-medium rounded-full border",style:{backgroundColor:c.bgColor,color:c.color,borderColor:c.color+"40"},title:c.description,children:[(0,d.jsx)("span",{className:"mr-1",children:c.icon}),c.text]}),b.agent_id&&(0,d.jsxs)("div",{className:`text-xs ${a?"text-gray-500":"text-gray-400"}`,children:[(0,d.jsx)(l,{className:"h-3 w-3 inline mr-1"}),b.last_synced?new Date(b.last_synced).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Never"]})]})})()}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[b.agent_id?(0,d.jsx)("button",{onClick:()=>W(b.id),className:`p-1.5 rounded-md transition-colors ${a?"text-gray-400 hover:text-white hover:bg-gray-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,title:"VAPI Configuration",children:(0,d.jsx)(m.A,{className:"h-4 w-4"})}):(0,d.jsx)("div",{className:"p-1.5 w-7 h-7",children:" "}),(0,d.jsx)("button",{onClick:()=>(a=>{let b=z.find(b=>b.id===a);b&&(K({status:b.status,addMinutes:"1",planSubscription:b.plan||"basic"}),G({isOpen:!0,user:b}))})(b.id),className:`p-1.5 rounded-md transition-colors ${a?"text-gray-400 hover:text-white hover:bg-gray-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,title:"Edit User",children:(0,d.jsx)(n.A,{className:"h-4 w-4"})}),(0,d.jsx)("button",{onClick:()=>(a=>{let b=z.find(b=>b.id===a);b&&E({isOpen:!0,user:b})})(b.id),className:`p-1.5 rounded-md transition-colors ${a?"text-gray-400 hover:text-red-400 hover:bg-gray-600":"text-gray-500 hover:text-red-600 hover:bg-gray-100"}`,title:"Delete User",children:(0,d.jsx)(o,{className:"h-4 w-4"})})]})})]},b.id)})})]})}),0===V.length&&(0,d.jsxs)("div",{className:"text-center py-12",children:[(0,d.jsx)(j.A,{className:`mx-auto h-12 w-12 ${a?"text-gray-600":"text-gray-400"}`}),(0,d.jsx)("h3",{className:`mt-2 text-sm font-medium ${a?"text-gray-300":"text-gray-900"}`,children:"No users found"}),(0,d.jsx)("p",{className:`mt-1 text-sm ${a?"text-gray-400":"text-gray-500"}`,children:"Try adjusting your search terms."})]})]}),(0,d.jsx)(s.A,{isOpen:F.isOpen,onClose:Z,title:"Manage User",customContent:F.user?(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-4 pb-3 border-b border-gray-200 dark:border-gray-700",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white font-semibold text-sm",style:{backgroundColor:r.T.zB},children:"LOGO"})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:`font-semibold text-base ${a?"text-white":"text-gray-900"}`,children:F.user.name}),(0,d.jsx)("p",{className:`text-xs ${a?"text-gray-400":"text-gray-600"}`,children:F.user.id})]}),(0,d.jsx)("div",{className:"text-right",children:(0,d.jsxs)("p",{className:`text-xs font-medium ${a?"text-gray-300":"text-gray-700"}`,children:[F.user.minutes_used,"/",F.user.minutes_allowed," minutes"]})})]}),(0,d.jsx)("div",{className:`h-1.5 rounded-full mt-1 ${a?"bg-gray-700":"bg-gray-200"}`,children:(0,d.jsx)("div",{className:"h-1.5 rounded-full",style:{backgroundColor:r.T.zB,width:`${Math.min(F.user.minutes_used/F.user.minutes_allowed*100,100)}%`}})})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`block text-sm font-medium mb-1.5 ${a?"text-gray-300":"text-gray-700"}`,children:"User Status"}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)("select",{value:J.status,onChange:a=>$("status",a.target.value),disabled:L,className:`custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-pointer ${L?"opacity-50 cursor-not-allowed":""} ${a?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500`,children:[(0,d.jsx)("option",{value:"Active",children:"Active"}),(0,d.jsx)("option",{value:"Inactive",children:"Inactive"})]}),(0,d.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,d.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`block text-sm font-medium mb-1.5 ${a?"text-gray-300":"text-gray-700"}`,children:"Add Minutes"}),(0,d.jsx)("input",{type:"number",value:J.addMinutes,onChange:a=>$("addMinutes",a.target.value),disabled:L,className:`w-full px-3 py-2 border rounded-lg text-sm ${L?"opacity-50 cursor-not-allowed":""} ${a?"bg-gray-800 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"} focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500`,placeholder:"Enter minutes to add",min:"1"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`block text-sm font-medium mb-1.5 ${a?"text-gray-300":"text-gray-700"}`,children:"Plan Subscription"}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)("select",{value:J.planSubscription,onChange:a=>$("planSubscription",a.target.value),disabled:L,className:`custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-pointer ${L?"opacity-50 cursor-not-allowed":""} ${a?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500`,children:[(0,d.jsx)("option",{value:"basic",children:"Basic"}),(0,d.jsx)("option",{value:"premium",children:"Premium"}),(0,d.jsx)("option",{value:"enterprise",children:"Enterprise"})]}),(0,d.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,d.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`block text-sm font-medium mb-1.5 ${a?"text-gray-300":"text-gray-700"}`,children:"Restaurant Location"}),(0,d.jsx)("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} leading-relaxed`,children:F.user?.location||"No location specified"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`block text-sm font-medium mb-1.5 ${a?"text-gray-300":"text-gray-700"}`,children:"Restaurant Description"}),(0,d.jsx)("p",{className:`text-sm leading-relaxed ${a?"text-gray-400":"text-gray-600"}`,children:F.user?.description||"No description provided"})]})]})]})]}):null,primaryButton:{text:L?(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Saving..."]}):"Save Changes",onClick:Y,disabled:L},secondaryButton:{text:"Cancel",onClick:Z}}),(0,d.jsx)(s.A,{isOpen:D.isOpen,onClose:X,icon:(0,d.jsx)(p.A,{className:"h-8 w-8"}),title:"Delete User",description:D.user?`Are you sure you want to delete "${D.user.name}"? This action cannot be undone and will permanently remove all data associated with this user account.`:"",primaryButton:{text:"Delete User",onClick:()=>{D.user&&(h.vF.logUserAction("USER_DELETED",D.user.email,`Admin deleted user: ${D.user.name} (ID: ${D.user.id})`),b(`User ${D.user.name} has been deleted successfully`),E({isOpen:!1,user:null}))}},secondaryButton:{text:"Cancel",onClick:X}}),(0,d.jsx)(s.A,{isOpen:H.isOpen,onClose:ab,title:"VAPI Configuration",customContent:(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)("div",{className:"flex items-center justify-end space-x-2",children:R.isEditing?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:()=>{R.selectedUser&&_("selectedUser",R.selectedUser),S(a=>({...a,isEditing:!1}))},className:"px-3 py-2 text-sm font-medium rounded-md border transition-colors",style:{color:a?r.T.Oh.Sh:r.T.Oh.eD,borderColor:a?r.T.Oh.l8:r.T.Oh.Sh},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=a?r.T.Oh.eD:r.T.Oh[50]},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent"},children:"Cancel"}),(0,d.jsx)("button",{onClick:aa,className:"px-3 py-2 text-sm font-medium text-white rounded-md transition-colors",style:{backgroundColor:r.T.zB},children:"Save Changes"})]}):(0,d.jsxs)("button",{onClick:()=>{console.log("\uD83D\uDD27 Starting VAPI edit mode"),S(a=>({...a,isEditing:!0}))},disabled:!R.selectedUser,className:`inline-flex items-center px-3 py-2 text-sm font-medium rounded-md border transition-colors ${!R.selectedUser?"opacity-50 cursor-not-allowed":""}`,style:{color:a?r.T.Oh.Sh:r.T.Oh.eD,borderColor:a?r.T.Oh.l8:r.T.Oh.Sh},onMouseEnter:b=>{R.selectedUser&&(b.currentTarget.style.backgroundColor=a?r.T.Oh.eD:r.T.Oh[50])},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent"},children:[(0,d.jsx)(n.A,{className:"h-4 w-4 mr-2"}),"Edit"]})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"mb-2",children:(0,d.jsx)("label",{className:"text-sm font-medium",style:{color:a?r.T.Oh.Sh:r.T.Oh.eD},children:"Select User"})}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)("select",{value:R.selectedUser,onChange:a=>_("selectedUser",a.target.value),className:`custom-select w-full px-3 py-2 border rounded-lg text-sm appearance-none cursor-pointer ${a?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500`,children:[(0,d.jsx)("option",{value:"",children:"-- Select a user --"}),z.filter(a=>a.agent_id).map(a=>(0,d.jsxs)("option",{value:a.id.toString(),children:[a.name," (#",a.id,")"]},a.id))]}),(0,d.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,d.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),!R.selectedUser&&(0,d.jsxs)("div",{className:"text-center py-12",children:[(0,d.jsx)(q.A,{className:`mx-auto h-12 w-12 ${a?"text-gray-600":"text-gray-400"}`,style:{color:a?r.T.Oh.l8:r.T.Oh.jC}}),(0,d.jsx)("h3",{className:"mt-2 text-sm font-medium",style:{color:a?r.T.Oh.Sh:r.T.Oh.uu},children:"Select a user to manage their VAPI configurations"}),(0,d.jsx)("p",{className:"mt-1 text-sm",style:{color:a?r.T.Oh.jC:r.T.Oh.C2},children:"Choose a user from the dropdown above to configure their assistant settings."})]}),R.selectedUser&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:`${a?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"} rounded-lg border p-4 mb-4`,children:[(0,d.jsx)("h4",{className:`text-sm font-semibold mb-3 ${a?"text-white":"text-gray-900"}`,children:"User Information"}),(()=>{let b=z.find(a=>a.id.toString()===R.selectedUser);return b?(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`text-xs font-medium uppercase tracking-wide ${a?"text-gray-400":"text-gray-500"}`,children:"Restaurant Name"}),(0,d.jsx)("p",{className:`text-sm font-medium ${a?"text-white":"text-gray-900"}`,children:b.name})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`text-xs font-medium uppercase tracking-wide ${a?"text-gray-400":"text-gray-500"}`,children:"Email"}),(0,d.jsx)("p",{className:`text-sm ${a?"text-gray-300":"text-gray-600"}`,children:b.email})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`text-xs font-medium uppercase tracking-wide ${a?"text-gray-400":"text-gray-500"}`,children:"Agent ID"}),(0,d.jsx)("p",{className:`text-sm ${a?"text-gray-300":"text-gray-600"}`,children:b.agent_id?(0,d.jsx)("span",{className:"font-mono text-xs bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded",children:b.agent_id}):(0,d.jsx)("span",{className:"text-gray-400 italic",children:"No agent assigned"})})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:`text-xs font-medium uppercase tracking-wide ${a?"text-gray-400":"text-gray-500"}`,children:"Status"}),(0,d.jsx)("p",{className:"text-sm",children:(0,d.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${"active"===b.status.toLowerCase()?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300"}`,children:b.status})})]})]}):null})()]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"mb-2",children:(0,d.jsx)("label",{className:"text-sm font-medium",style:{color:a?r.T.Oh.Sh:r.T.Oh.eD},children:"Starting Message"})}),R.isEditing?(0,d.jsx)("input",{type:"text",value:R.startingMessage,onChange:a=>_("startingMessage",a.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500/20",style:{backgroundColor:a?r.T.Oh.eD:r.T.ON,borderColor:a?r.T.Oh.l8:r.T.Oh.Sh,color:a?r.T.ON:r.T.Oh.uu},onFocus:a=>{a.currentTarget.style.borderColor=r.T.zB},onBlur:b=>{b.currentTarget.style.borderColor=a?r.T.Oh.l8:r.T.Oh.Sh},placeholder:"Enter starting message"}):(0,d.jsx)("p",{className:"text-sm rounded-md p-3",style:{color:a?r.T.Oh.Sh:r.T.Oh.eD,backgroundColor:a?r.T.Oh.eD:r.T.Oh.Id},children:R.startingMessage})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"mb-2",children:(0,d.jsx)("label",{className:"text-sm font-medium",style:{color:a?r.T.Oh.Sh:r.T.Oh.eD},children:"System Prompt"})}),R.isEditing?(0,d.jsx)("textarea",{rows:8,value:R.systemPrompt,onChange:a=>_("systemPrompt",a.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-orange-500/20",style:{backgroundColor:a?r.T.Oh.eD:r.T.ON,borderColor:a?r.T.Oh.l8:r.T.Oh.Sh,color:a?r.T.ON:r.T.Oh.uu},onFocus:a=>{a.currentTarget.style.borderColor=r.T.zB},onBlur:b=>{b.currentTarget.style.borderColor=a?r.T.Oh.l8:r.T.Oh.Sh},placeholder:"Enter system prompt"}):(0,d.jsx)("div",{className:"text-sm rounded-md p-3 whitespace-pre-wrap max-h-48 overflow-y-auto",style:{color:a?r.T.Oh.Sh:r.T.Oh.eD,backgroundColor:a?r.T.Oh.eD:r.T.Oh.Id},children:R.systemPrompt})]})]})]})]}),secondaryButton:{text:"Close",onClick:ab}})]})})]})}},92073:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(38301);let e=d.forwardRef(function({title:a,titleId:b,...c},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},c),a?d.createElement("title",{id:b},a):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))})}};